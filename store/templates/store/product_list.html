{% extends 'store/base.html' %}
{% load static %}
{% block content %}

<h2 class="mt-4">All Medicines</h2>
<div class="row mt-3">
  {% for med in medicines %}
  <div class="col-md-3 mb-4">
    <div class="card medicine-card">
      <div class="position-relative">
        {% if med.image %}
        <img src="{{ med.image.url }}" class="card-img-top" alt="{{ med.name }}">
        {% else %}
        <img src="{% static 'images/sample_medicine.jpg' %}" class="card-img-top" alt="{{ med.name }}">
        {% endif %}
      </div>
      <div class="card-body">
        <h5 class="card-title text-truncate" title="{{ med.name }}">{{ med.name }}</h5>
        <p class="price">${{ med.price }}</p>
        <div class="mt-auto d-grid gap-2">
          <form class="add-ajax-form w-100" action="{% url 'add_to_cart_ajax' med.id %}" method="post">
            {% csrf_token %}
            <input type="hidden" name="quantity" value="1">
            <button type="submit" class="btn btn-success w-100">
              <i class="fas fa-cart-plus me-1"></i> Add to Cart
            </button>
          </form>
          <a href="{% url 'product_detail' med.pk %}" class="btn btn-outline-primary w-100">View Details</a>
        </div>
      </div>
    </div>
  </div>
  {% empty %}
  <p>No products found.</p>
  {% endfor %}
</div>

<div class="d-flex justify-content-center mt-3">
  {% if medicines.has_previous %}
  <a href="?page={{ medicines.previous_page_number }}" class="btn btn-outline-primary me-2">Previous</a>
  {% endif %}
  <span class="align-self-center">Page {{ medicines.number }} of {{ medicines.paginator.num_pages }}</span>
  {% if medicines.has_next %}
  <a href="?page={{ medicines.next_page_number }}" class="btn btn-outline-primary ms-2">Next</a>
  {% endif %}
</div>

{% endblock %}